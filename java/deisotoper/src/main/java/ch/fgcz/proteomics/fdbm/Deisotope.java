package ch.fgcz.proteomics.fdbm;

/**
 * @author Lucas Schmidt
 * @since 2017-09-21
 */

import java.text.SimpleDateFormat;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.List;

import org.jgrapht.GraphPath;

import ch.fgcz.proteomics.dto.MassSpectrometryMeasurement;
import ch.fgcz.proteomics.dto.MassSpectrum;
import ch.fgcz.proteomics.dto.Summary;
import ch.fgcz.proteomics.fdbm.IsotopicClusterGraph;
import ch.fgcz.proteomics.utilities.Sort;

public class Deisotope {
    private static double time = 0;

    public MassSpectrometryMeasurement deisotopeMSM(MassSpectrometryMeasurement input, boolean save, String modus, String file, double percent, double error, double delta) {
        MassSpectrometryMeasurement output = new MassSpectrometryMeasurement(input.getSource() + "_output");

        ScoreConfig config = new ScoreConfig(file);

        String date = new SimpleDateFormat("yyyyMMdd_HHmm").format(new Date());

        for (MassSpectrum ms : input.getMSlist()) { // input.getMSlist().parallelStream().forEach((ms) -> {$
            output.getMSlist().add(deisotopeMS(ms, save, modus, config, date, percent, error, delta));
        }

        return output;
    }

    //TODO (LS): never used
    public MassSpectrum deisotopeMS(MassSpectrum input, boolean save, String modus, ScoreConfig config, double percent, double error, double delta) {
        String date = new SimpleDateFormat("yyyyMMdd_HHmm").format(new Date());

        return deisotopeMS(input, save, modus, config, date, percent, error, delta);
    }

    public MassSpectrum deisotopeMS(MassSpectrum input, boolean save, String modus, ScoreConfig config, String date, double percent, double error, double delta) {
        IsotopicMassSpectrum ims = new IsotopicMassSpectrum(input, delta);

        if (save == true) {
            ims.makeStatistics(date, input.getMz().size());
        }

        List<Double> mz = new ArrayList<>();
        List<Double> intensity = new ArrayList<>();
        List<Double> isotope = new ArrayList<>();
        List<Integer> charge = new ArrayList<>();

        List<Double> mz3 = new ArrayList<>();

        for (IsotopicSet is : ims.getIsotopicMassSpectrum()) {
            IsotopicClusterGraph icg = new IsotopicClusterGraph(is);

            icg.scoreIsotopicClusterGraph(input.getPeptideMass(), input.getChargeState(), error, new Peaklist(input.getMz(), input.getIntensity()), config);

            GraphPath<IsotopicCluster, Connection> bp = icg.bestPath(getStart(icg), getEnd(icg));

            if (save == true) {
                icg.drawDOTIsotopicClusterGraph(is.getSetID(), input.getId(), date);
            }

            List<Double> mz2 = new ArrayList<>();
            List<Double> intensity2 = new ArrayList<>();
            List<Double> isotope2 = new ArrayList<>();
            List<Integer> charge2 = new ArrayList<>();

            List<Double> mz4 = new ArrayList<>();

            for (IsotopicCluster cluster : bp.getVertexList()) {
                if (cluster.getIsotopicCluster() != null) {

                    for (Peak p : cluster.getIsotopicCluster()) {
                        mz4.add(p.getMz());
                    }

                    aggregation(cluster, modus);

                    int position = 1;
                    for (Peak p : cluster.getIsotopicCluster()) {
                        mz2.add(p.getMz());
                        intensity2.add(p.getIntensity());
                        isotope2.add((double) position);
                        charge2.add(cluster.getCharge());
                        position++;
                    }
                }
            }

            mz.addAll(mz2);
            intensity.addAll(intensity2);
            isotope.addAll(isotope2);
            charge.addAll(charge2);

            mz3.addAll(mz4);
        }

        for (int i = 0; i < input.getMz().size(); i++) {
            if (!mz3.contains(input.getMz().get(i))) {
                mz.add(input.getMz().get(i));
                intensity.add(input.getIntensity().get(i));
                isotope.add(-1.0);
                charge.add(-1);
            }
        }

        Sort.keySort(mz, mz, intensity, isotope, charge);

        if (percent != 0) {
            double threshold = Collections.max(mz) * percent / 100;

            List<Double> mz5 = new ArrayList<>();
            List<Double> intensity5 = new ArrayList<>();
            List<Double> isotope5 = new ArrayList<>();
            List<Integer> charge5 = new ArrayList<>();

            for (int i = 0; i < mz.size(); i++) {
                if (threshold < mz.get(i)) {
                    mz5.add(mz.get(i));
                    intensity5.add(intensity.get(i));
                    isotope5.add(isotope.get(i));
                    charge5.add(charge.get(i));
                }
            }
            return new MassSpectrum(input.getTyp(), input.getSearchEngine(), mz5, intensity5, input.getPeptideMass(), input.getRt(), input.getChargeState(), input.getId(), charge5, isotope5);
        } else {
            return new MassSpectrum(input.getTyp(), input.getSearchEngine(), mz, intensity, input.getPeptideMass(), input.getRt(), input.getChargeState(), input.getId(), charge, isotope);
        }
    }

    private IsotopicCluster getStart(IsotopicClusterGraph icg) {
        for (IsotopicCluster e : icg.getIsotopicclustergraph().vertexSet()) {
            if (e.getIsotopicCluster() == null && e.getStatus() == "start") {
                return e;
            }
        }
        return null;
    }

    private IsotopicCluster getEnd(IsotopicClusterGraph icg) {
        for (IsotopicCluster e : icg.getIsotopicclustergraph().vertexSet()) {
            if (e.getIsotopicCluster() == null && e.getStatus() == "end") {
                return e;
            }
        }
        return null;
    }

    private IsotopicCluster aggregation(IsotopicCluster cluster, String modus) {
        if (modus.equals("first")) {
            return cluster.simpleAggregateFirst();
        } else if (modus.equals("last")) {
            return cluster.simpleAggregateLast();
        } else if (modus.equals("mean")) {
            return cluster.simpleAggregateMean();
        } else if (modus.equals("highest")) {
            return cluster.advancedAggregateHighest();
        } else if (modus.equals("none")) {
            return cluster;
        } else {
            throw new IllegalArgumentException("Modus not found (" + modus + ")");
        }
    }

    public static void main(String[] args) {
        runtimeBenchmark();

        // testDeisotope();
    }

    private static void testDeisotope() {
        String typ = "MS2 Spectrum";
        String searchengine = "mascot";
        double[] mz = { 110.0715485, 110.1648788, 112.0395432, 113.0712204, 114.0746384, 115.05056, 115.9784622, 120.080986, 120.0833893, 121.0843735, 125.7498245, 129.0659332, 129.1023102,
                130.0863342, 130.1057281, 131.0815735, 132.0849609, 132.5098419, 137.0346222, 141.0658417, 143.0816193, 145.0608368, 147.1128235, 149.0233917, 150.0266876, 153.0657654, 157.0970917,
                159.076416, 160.0798035, 162.0875397, 162.0912323, 167.0816345, 170.092392, 171.0762177, 172.8989868, 175.118927, 180.0767212, 185.0920105, 189.1023407, 198.0873413, 199.0907135,
                204.0980682, 205.0570374, 207.1127777, 208.0717316, 210.0866547, 210.7322388, 211.5193329, 212.10289, 214.0822296, 216.0977783, 223.0636444, 224.1031799, 225.0603638, 226.0820923,
                227.0399933, 227.1023407, 228.098175, 230.1135101, 231.1125488, 231.1492462, 232.0926361, 232.2126312, 233.1646729, 235.1072845, 240.09758, 241.129364, 242.1128387, 246.1234741,
                249.098175, 253.0928345, 254.1314087, 254.6329193, 255.1085358, 258.1084595, 259.1398315, 263.1368713, 267.1086426, 268.1119995, 269.1243591, 271.1038513, 273.1199646, 274.1184998,
                276.1701965, 277.0926819, 277.1541138, 278.4438171, 279.108429, 285.1191101, 287.1348877, 289.650177, 292.1772461, 294.1808777, 295.1038513, 295.184082, 296.1346436, 297.1190491,
                299.0617065, 300.133606, 301.0583801, 303.1295166, 310.4591064, 314.1459961, 315.129303, 318.1446228, 318.1605225, 324.1297607, 328.1278992, 331.8494568, 332.1560364, 333.1555786,
                334.114502, 338.1456299, 342.1403198, 343.1411133, 346.176239, 351.1661377, 356.1558228, 357.1579285, 357.6632385, 358.1647949, 360.1513672, 360.6679077, 361.1502075, 363.2023926,
                366.6683655, 368.6846924, 375.1660156, 375.2023926, 379.1607361, 381.2128296, 382.2158813, 387.1657104, 388.1895447, 390.9455261, 395.1658325, 397.1503906, 397.1950684, 397.6967163,
                400.1613159, 403.135437, 403.1973877, 411.1614075, 418.1715698, 420.2235107, 421.1462402, 421.2265015, 426.1759949, 438.2343445, 439.2384644, 443.2040405, 444.1874084, 454.1725464,
                461.2140198, 462.1977844, 471.1980896, 472.2180786, 479.2248535, 482.1990967, 489.2085571, 490.2118835, 490.2296448, 495.2563477, 507.2199402, 507.2555847, 508.2598572, 525.2663574,
                526.2697754, 577.2515259, 578.2937012, 584.8656006, 596.3037109, 597.3069458, 617.3034668, 618.2872925, 635.3146362, 636.3175049, 653.3252563, 654.3284302 };
        double[] intensity = { 6250.6640625, 563.5891113281, 787.7743530273, 42913.109375, 927.4467773438, 2023.1707763672, 529.0408325195, 25228.6796875, 1165.1545410156, 603.5643310547,
                528.4467773438, 7070.5766601563, 31543.533203125, 19388.078125, 833.7221679688, 81864.546875, 3091.2973632813, 582.6003417969, 6660.9750976563, 34947.4921875, 684.2407836914,
                3036.4206542969, 36999.45703125, 2973.7102050781, 829.9125366211, 6804.5180664063, 1259.5620117188, 46302.8125, 2067.9748535156, 1154.1105957031, 765.7245483398, 794.5812988281,
                4291.3037109375, 888.9245605469, 606.1282958984, 766.3591918945, 14302.1279296875, 3288.0661621094, 688.5368652344, 35533.54296875, 2225.658203125, 670.2319335938, 677.4953613281,
                6984.8188476563, 2347.3420410156, 594.0815429688, 2258.9313964844, 568.3290405273, 802.1146850586, 3599.0229492188, 7246.6596679688, 2139.9233398438, 828.2638549805, 884.8049316406,
                1193.3479003906, 566.4050292969, 786.0283813477, 615.2380981445, 1079.8623046875, 1339.6888427734, 806.2881469727, 9631.443359375, 569.907409668, 1065.3564453125, 991.0939331055,
                690.4099731445, 3580.0187988281, 672.0654296875, 845.2703857422, 1281.3441162109, 559.6304931641, 4143.1162109375, 1155.7521972656, 2598.6123046875, 953.2352905273, 3944.8764648438,
                7301.6743164063, 4961.2807617188, 569.8205566406, 2566.8024902344, 795.173828125, 757.6403808594, 3254.8908691406, 7315.53515625, 1220.8388671875, 1115.0716552734, 524.3715820313,
                676.455871582, 2324.4851074219, 808.6432495117, 1269.125, 581.4161376953, 31443.404296875, 2546.380859375, 2911.2058105469, 780.770324707, 738.4011230469, 1135.4598388672,
                1176.7568359375, 3533.0815429688, 2457.2565917969, 562.0629882813, 928.1300048828, 1034.6174316406, 1035.1872558594, 2155.4260253906, 3214.2192382813, 586.0258178711, 545.24609375,
                2240.283203125, 3230.6267089844, 1323.4107666016, 924.3392944336, 8073.1616210938, 767.8354492188, 789.9375610352, 2135.9985351563, 999.5626831055, 642.1485595703, 7692.0913085938,
                1246.6643066406, 4829.984375, 799.643371582, 3193.9008789063, 1350.830078125, 901.1105957031, 687.5123901367, 996.9341430664, 1064.1864013672, 911.1711425781, 16409.24609375,
                1171.5484619141, 960.3439331055, 935.4268188477, 677.4844970703, 657.7783813477, 2241.4836425781, 8700.474609375, 782.1491699219, 686.3291015625, 785.7287597656, 753.0210571289,
                714.055847168, 2145.2751464844, 5911.2006835938, 1220.7615966797, 623.0693969727, 634.6696777344, 33137.39453125, 5135.7211914063, 813.663269043, 1231.4427490234, 933.5162963867,
                3532.599609375, 1009.3364868164, 3219.3342285156, 800.7995605469, 3228.8891601563, 1368.7080078125, 6327.9125976563, 810.8509521484, 1239.9750976563, 791.6758422852, 1281.634765625,
                6519.0903320313, 575.096496582, 65968.4140625, 11777.5908203125, 2284.7736816406, 2809.2331542969, 622.4571533203, 22998.53515625, 3657.8000488281, 1279.3221435547, 1236.6485595703,
                9816.9814453125, 1331.3529052734, 87058.9140625, 21567.640625 };
        double peptidmass = 406.2002;
        double rt = 34.88659;
        int chargestate = 2;
        int id = 0;

        String typ2 = "MS2 Spectrum";
        String searchengine2 = "mascot";
        double[] mz2 = { 110.0715561, 111.8610229, 114.1390686, 120.0810623, 129.0660095, 129.1023407, 130.0863495, 132.0810089, 139.0865326, 140.0706635, 141.0740509, 143.6311035, 144.4211426,
                147.0765533, 147.1128082, 149.071167, 149.0787201, 150.8496857, 151.7207642, 152.4041443, 152.6655426, 158.0813751, 159.0917816, 159.1131744, 167.081604, 168.0655975, 169.0607758,
                169.1337433, 170.0600433, 172.8981781, 175.1192474, 177.5897522, 183.2910461, 184.4230652, 185.0920258, 186.0953522, 187.1441803, 195.0765533, 196.4373932, 197.1284637, 197.7965393,
                201.1235504, 203.1025696, 204.1342926, 207.1127472, 211.4206696, 211.4256287, 212.1028748, 213.0869446, 215.1390839, 217.0818329, 222.1237335, 223.0710297, 225.1237335, 230.1137543,
                231.0972137, 240.0977325, 240.1340332, 240.60849, 241.0817261, 241.100647, 243.1338959, 258.1082458, 258.1444092, 269.2312012, 276.1551514, 280.1652832, 282.4821167, 285.4057312,
                298.1757507, 308.1601563, 323.6738281, 326.1708679, 330.7650757, 352.112793, 368.1928101, 369.1398315, 369.1757507, 371.1920776, 386.2032166, 387.1508179, 387.1869507, 387.2027893,
                387.2068787, 395.2292786, 399.1523132, 404.2136536, 413.0435791, 425.8088989, 429.7384949, 438.2342224, 438.8492432, 439.843811, 459.6753235, 497.2355042, 498.2195129, 498.2379761,
                499.2226868, 515.2456665, 516.2489014, 533.2565918, 534.2587891, 546.1281738, 563.2313843, 610.3203735, 614.8796387, 646.3406372, 647.3439941, 747.3895264, 892.5530396 };
        double[] intensity2 = { 1000.1350097656, 459.3703613281, 519.1496582031, 781.0161132813, 2526.6721191406, 11320.5927734375, 7084.2470703125, 842.3206176758, 1135.3817138672, 18157.3125,
                786.469909668, 490.9208679199, 576.0399780273, 2261.421875, 16663.58203125, 499.9517211914, 688.5201416016, 519.2963256836, 797.7744140625, 481.8589477539, 478.0321044922,
                4551.6142578125, 2674.5727539063, 532.3534545898, 4554.9936523438, 942.9102783203, 630.2772827148, 1151.7127685547, 5868.7631835938, 524.7658081055, 876.7496948242, 563.5301513672,
                583.0883789063, 453.0282592773, 11805.900390625, 505.899017334, 6339.0668945313, 5552.0092773438, 602.1333007813, 980.5944213867, 506.7865905762, 542.5009155273, 4265.900390625,
                2223.9006347656, 661.8003540039, 884.8544311523, 1384.0025634766, 2760.4465332031, 7811.0014648438, 2927.7336425781, 638.9751586914, 696.5787353516, 530.7892456055, 648.5638427734,
                889.94921875, 1170.0031738281, 13165.86328125, 3567.0439453125, 598.9104003906, 2136.6420898438, 550.4777832031, 4788.4853515625, 7577.4145507813, 9951.6845703125, 633.6901245117,
                8566.72265625, 6111.5356445313, 603.5051269531, 547.0169067383, 1030.9359130859, 3526.8361816406, 775.7020874023, 977.0328979492, 573.4454956055, 942.9322509766, 856.3784790039,
                1111.9583740234, 1140.8024902344, 1289.6633300781, 9985.4521484375, 1866.3151855469, 15186.7138671875, 750.4580688477, 782.4721069336, 1077.7072753906, 545.8282470703, 7053.7202148438,
                513.7174682617, 622.5845336914, 553.4197998047, 688.5629272461, 1012.749206543, 1117.6733398438, 527.3670043945, 697.4555664063, 6784.0971679688, 739.5375366211, 874.3876342773,
                24654.7109375, 3577.7976074219, 24185.4765625, 2528.0358886719, 574.4848632813, 647.6321411133, 2600.6940917969, 493.2133178711, 10003.0302734375, 2482.6206054688, 736.8714599609,
                509.7579040527 };
        double peptidmass2 = 438.7188;
        double rt2 = 35.03545;
        int chargestate2 = 2;
        int id2 = 1;

        String typ3 = "MS2 Spectrum";
        String searchengine3 = "mascot";
        double[] mz3 = { 110.071434, 111.1172791, 114.1379471, 115.0867233, 116.0709763, 120.0810165, 129.1023407, 130.0863647, 133.0608063, 136.0757599, 137.1325684, 141.1022949, 142.0866089,
                142.1057892, 143.0815582, 143.1180725, 145.0971985, 147.1128387, 149.0231323, 149.0813293, 153.950592, 155.1178741, 156.1019897, 157.1336212, 161.0919037, 166.08638, 172.9013824,
                173.0922699, 175.1192627, 182.128952, 183.1128235, 184.0970459, 185.164917, 187.1438446, 189.0869904, 193.0972748, 199.0714569, 200.1394196, 201.1234436, 202.1267395, 210.5132599,
                217.0818939, 218.1499176, 218.8685608, 219.1531982, 228.0976715, 229.0282898, 229.118103, 231.3766327, 241.3804626, 243.1742859, 244.0929565, 244.1292114, 246.1555176, 254.1499023,
                255.007843, 257.1898193, 258.0890808, 258.8848572, 260.1241455, 270.1082764, 271.111969, 272.6676941, 272.8900452, 277.4067383, 285.0091858, 288.1187439, 289.1868591, 290.1903687,
                293.122467, 303.1463318, 314.6676025, 321.1767273, 332.3607788, 334.8108215, 340.820343, 341.1454163, 349.6712341, 349.6844482, 359.1559448, 367.1973877, 367.209137, 367.2991333,
                390.234314, 391.2380066, 447.3330994, 487.2503357, 488.235321, 488.2549133, 502.703064, 505.2611084, 506.2651672, 521.2680664, 544.3269043, 545.3035889, 615.1711426, 655.3071899 };
        double[] intensity3 = { 554.5115356445, 576.2714233398, 470.5877075195, 831.346862793, 808.5812988281, 540.8423461914, 15454.1044921875, 10687.373046875, 2562.8276367188, 985.1844482422,
                5154.5366210938, 11838.80078125, 746.5007324219, 590.8298339844, 2232.1176757813, 2862.2277832031, 999.6495361328, 20458.943359375, 549.176574707, 564.7764282227, 541.6581420898,
                2744.7907714844, 13228.37109375, 1072.2976074219, 668.5700073242, 1015.8220214844, 566.4951171875, 3130.7785644531, 5293.4462890625, 984.9155883789, 10520.90234375, 2768.6892089844,
                2203.5717773438, 578.719909668, 2560.7993164063, 580.1266479492, 11263.375, 4808.3188476563, 122865.515625, 7319.7158203125, 2671.2126464844, 5787.3247070313, 24145.658203125,
                560.5859375, 893.0471801758, 981.86328125, 599.716003418, 3674.5551757813, 631.608215332, 567.0170288086, 7594.8212890625, 840.05859375, 791.4499511719, 533.7921142578, 714.3071289063,
                2784.4916992188, 2421.3828125, 539.7557373047, 665.4076538086, 787.3020629883, 22507.0078125, 1141.7131347656, 653.4030151367, 780.8794555664, 521.9017944336, 652.1410522461,
                13041.5927734375, 12533.13671875, 640.3876953125, 887.7508544922, 693.4885864258, 552.3706665039, 659.1276245117, 503.3168945313, 586.6461181641, 1149.9792480469, 1115.6361083984,
                626.9268188477, 555.3795166016, 2641.4448242188, 910.6457519531, 758.4725341797, 8677.2880859375, 11298.2587890625, 1102.0684814453, 550.0299072266, 4999.42578125, 900.1571044922,
                611.5407104492, 591.0953369141, 31726.78125, 5554.0678710938, 1095.4444580078, 889.14453125, 989.8300170898, 472.4118347168, 565.1219482422 };
        double peptidmass3 = 367.1894;
        double rt3 = 35.17022;
        int chargestate3 = 2;
        int id3 = 2;

        String s = "TesterinoData.RData";
        MassSpectrometryMeasurement msm = new MassSpectrometryMeasurement(s);
        msm.addMS(typ, searchengine, mz, intensity, peptidmass, rt, chargestate, id);
        msm.addMS(typ2, searchengine2, mz2, intensity2, peptidmass2, rt2, chargestate2, id2);
        msm.addMS(typ3, searchengine3, mz3, intensity3, peptidmass3, rt3, chargestate3, id3);

        System.out.println("Input:");
        for (MassSpectrum x : msm.getMSlist()) {
            for (int y = 0; y < x.getMz().size(); y++) {
                System.out.print("M: " + x.getMz().get(y) + ", ");
            }
            System.out.println();
        }
        System.out.println();

        Deisotope deiso = new Deisotope();

        System.out.println("Output:");
        for (MassSpectrum x : deiso.deisotopeMSM(msm, false, "mean", "AminoAcidMasses.ini", 5, 0.3, 0.01).getMSlist()) {
            for (int y = 0; y < x.getMz().size(); y++) {
                System.out.print("M: " + x.getMz().get(y) + ", ");
                System.out.print("Z: " + x.getCharge().get(y) + ", ");
                System.out.print("I: " + x.getIsotope().get(y) + ", ");
            }
            System.out.println();
        }
    }

    private static void runtimeBenchmark() {
        String s = "TesterinoData.RData";
        MassSpectrometryMeasurement msm = new MassSpectrometryMeasurement(s);

        int j = 0;
        for (int i = 0; i < 100; i++) {
            String typ = "MS2 Spectrum";
            String searchengine = "mascot";
            double[] mz = null;
            double[] intensity = null;
            if (j == 0) {
                double[] mz1 = { 110.0715485, 110.1648788, 112.0395432, 113.0712204, 114.0746384, 115.05056, 115.9784622, 120.080986, 120.0833893, 121.0843735, 125.7498245, 129.0659332, 129.1023102,
                        130.0863342, 130.1057281, 131.0815735, 132.0849609, 132.5098419, 137.0346222, 141.0658417, 143.0816193, 145.0608368, 147.1128235, 149.0233917, 150.0266876, 153.0657654,
                        157.0970917, 159.076416, 160.0798035, 162.0875397, 162.0912323, 167.0816345, 170.092392, 171.0762177, 172.8989868, 175.118927, 180.0767212, 185.0920105, 189.1023407,
                        198.0873413, 199.0907135, 204.0980682, 205.0570374, 207.1127777, 208.0717316, 210.0866547, 210.7322388, 211.5193329, 212.10289, 214.0822296, 216.0977783, 223.0636444,
                        224.1031799, 225.0603638, 226.0820923, 227.0399933, 227.1023407, 228.098175, 230.1135101, 231.1125488, 231.1492462, 232.0926361, 232.2126312, 233.1646729, 235.1072845,
                        240.09758, 241.129364, 242.1128387, 246.1234741, 249.098175, 253.0928345, 254.1314087, 254.6329193, 255.1085358, 258.1084595, 259.1398315, 263.1368713, 267.1086426,
                        268.1119995, 269.1243591, 271.1038513, 273.1199646, 274.1184998, 276.1701965, 277.0926819, 277.1541138, 278.4438171, 279.108429, 285.1191101, 287.1348877, 289.650177,
                        292.1772461, 294.1808777, 295.1038513, 295.184082, 296.1346436, 297.1190491, 299.0617065, 300.133606, 301.0583801, 303.1295166, 310.4591064, 314.1459961, 315.129303,
                        318.1446228, 318.1605225, 324.1297607, 328.1278992, 331.8494568, 332.1560364, 333.1555786, 334.114502, 338.1456299, 342.1403198, 343.1411133, 346.176239, 351.1661377,
                        356.1558228, 357.1579285, 357.6632385, 358.1647949, 360.1513672, 360.6679077, 361.1502075, 363.2023926, 366.6683655, 368.6846924, 375.1660156, 375.2023926, 379.1607361,
                        381.2128296, 382.2158813, 387.1657104, 388.1895447, 390.9455261, 395.1658325, 397.1503906, 397.1950684, 397.6967163, 400.1613159, 403.135437, 403.1973877, 411.1614075,
                        418.1715698, 420.2235107, 421.1462402, 421.2265015, 426.1759949, 438.2343445, 439.2384644, 443.2040405, 444.1874084, 454.1725464, 461.2140198, 462.1977844, 471.1980896,
                        472.2180786, 479.2248535, 482.1990967, 489.2085571, 490.2118835, 490.2296448, 495.2563477, 507.2199402, 507.2555847, 508.2598572, 525.2663574, 526.2697754, 577.2515259,
                        578.2937012, 584.8656006, 596.3037109, 597.3069458, 617.3034668, 618.2872925, 635.3146362, 636.3175049, 653.3252563, 654.3284302 };
                double[] intensity1 = { 6250.6640625, 563.5891113281, 787.7743530273, 42913.109375, 927.4467773438, 2023.1707763672, 529.0408325195, 25228.6796875, 1165.1545410156, 603.5643310547,
                        528.4467773438, 7070.5766601563, 31543.533203125, 19388.078125, 833.7221679688, 81864.546875, 3091.2973632813, 582.6003417969, 6660.9750976563, 34947.4921875, 684.2407836914,
                        3036.4206542969, 36999.45703125, 2973.7102050781, 829.9125366211, 6804.5180664063, 1259.5620117188, 46302.8125, 2067.9748535156, 1154.1105957031, 765.7245483398,
                        794.5812988281, 4291.3037109375, 888.9245605469, 606.1282958984, 766.3591918945, 14302.1279296875, 3288.0661621094, 688.5368652344, 35533.54296875, 2225.658203125,
                        670.2319335938, 677.4953613281, 6984.8188476563, 2347.3420410156, 594.0815429688, 2258.9313964844, 568.3290405273, 802.1146850586, 3599.0229492188, 7246.6596679688,
                        2139.9233398438, 828.2638549805, 884.8049316406, 1193.3479003906, 566.4050292969, 786.0283813477, 615.2380981445, 1079.8623046875, 1339.6888427734, 806.2881469727,
                        9631.443359375, 569.907409668, 1065.3564453125, 991.0939331055, 690.4099731445, 3580.0187988281, 672.0654296875, 845.2703857422, 1281.3441162109, 559.6304931641,
                        4143.1162109375, 1155.7521972656, 2598.6123046875, 953.2352905273, 3944.8764648438, 7301.6743164063, 4961.2807617188, 569.8205566406, 2566.8024902344, 795.173828125,
                        757.6403808594, 3254.8908691406, 7315.53515625, 1220.8388671875, 1115.0716552734, 524.3715820313, 676.455871582, 2324.4851074219, 808.6432495117, 1269.125, 581.4161376953,
                        31443.404296875, 2546.380859375, 2911.2058105469, 780.770324707, 738.4011230469, 1135.4598388672, 1176.7568359375, 3533.0815429688, 2457.2565917969, 562.0629882813,
                        928.1300048828, 1034.6174316406, 1035.1872558594, 2155.4260253906, 3214.2192382813, 586.0258178711, 545.24609375, 2240.283203125, 3230.6267089844, 1323.4107666016,
                        924.3392944336, 8073.1616210938, 767.8354492188, 789.9375610352, 2135.9985351563, 999.5626831055, 642.1485595703, 7692.0913085938, 1246.6643066406, 4829.984375, 799.643371582,
                        3193.9008789063, 1350.830078125, 901.1105957031, 687.5123901367, 996.9341430664, 1064.1864013672, 911.1711425781, 16409.24609375, 1171.5484619141, 960.3439331055,
                        935.4268188477, 677.4844970703, 657.7783813477, 2241.4836425781, 8700.474609375, 782.1491699219, 686.3291015625, 785.7287597656, 753.0210571289, 714.055847168, 2145.2751464844,
                        5911.2006835938, 1220.7615966797, 623.0693969727, 634.6696777344, 33137.39453125, 5135.7211914063, 813.663269043, 1231.4427490234, 933.5162963867, 3532.599609375,
                        1009.3364868164, 3219.3342285156, 800.7995605469, 3228.8891601563, 1368.7080078125, 6327.9125976563, 810.8509521484, 1239.9750976563, 791.6758422852, 1281.634765625,
                        6519.0903320313, 575.096496582, 65968.4140625, 11777.5908203125, 2284.7736816406, 2809.2331542969, 622.4571533203, 22998.53515625, 3657.8000488281, 1279.3221435547,
                        1236.6485595703, 9816.9814453125, 1331.3529052734, 87058.9140625, 21567.640625 };
                mz = mz1;
                intensity = intensity1;
            }
            if (j == 1) {
                double[] mz2 = { 110.0715561, 111.8610229, 114.1390686, 120.0810623, 129.0660095, 129.1023407, 130.0863495, 132.0810089, 139.0865326, 140.0706635, 141.0740509, 143.6311035,
                        144.4211426, 147.0765533, 147.1128082, 149.071167, 149.0787201, 150.8496857, 151.7207642, 152.4041443, 152.6655426, 158.0813751, 159.0917816, 159.1131744, 167.081604,
                        168.0655975, 169.0607758, 169.1337433, 170.0600433, 172.8981781, 175.1192474, 177.5897522, 183.2910461, 184.4230652, 185.0920258, 186.0953522, 187.1441803, 195.0765533,
                        196.4373932, 197.1284637, 197.7965393, 201.1235504, 203.1025696, 204.1342926, 207.1127472, 211.4206696, 211.4256287, 212.1028748, 213.0869446, 215.1390839, 217.0818329,
                        222.1237335, 223.0710297, 225.1237335, 230.1137543, 231.0972137, 240.0977325, 240.1340332, 240.60849, 241.0817261, 241.100647, 243.1338959, 258.1082458, 258.1444092,
                        269.2312012, 276.1551514, 280.1652832, 282.4821167, 285.4057312, 298.1757507, 308.1601563, 323.6738281, 326.1708679, 330.7650757, 352.112793, 368.1928101, 369.1398315,
                        369.1757507, 371.1920776, 386.2032166, 387.1508179, 387.1869507, 387.2027893, 387.2068787, 395.2292786, 399.1523132, 404.2136536, 413.0435791, 425.8088989, 429.7384949,
                        438.2342224, 438.8492432, 439.843811, 459.6753235, 497.2355042, 498.2195129, 498.2379761, 499.2226868, 515.2456665, 516.2489014, 533.2565918, 534.2587891, 546.1281738,
                        563.2313843, 610.3203735, 614.8796387, 646.3406372, 647.3439941, 747.3895264, 892.5530396 };
                double[] intensity2 = { 1000.1350097656, 459.3703613281, 519.1496582031, 781.0161132813, 2526.6721191406, 11320.5927734375, 7084.2470703125, 842.3206176758, 1135.3817138672,
                        18157.3125, 786.469909668, 490.9208679199, 576.0399780273, 2261.421875, 16663.58203125, 499.9517211914, 688.5201416016, 519.2963256836, 797.7744140625, 481.8589477539,
                        478.0321044922, 4551.6142578125, 2674.5727539063, 532.3534545898, 4554.9936523438, 942.9102783203, 630.2772827148, 1151.7127685547, 5868.7631835938, 524.7658081055,
                        876.7496948242, 563.5301513672, 583.0883789063, 453.0282592773, 11805.900390625, 505.899017334, 6339.0668945313, 5552.0092773438, 602.1333007813, 980.5944213867,
                        506.7865905762, 542.5009155273, 4265.900390625, 2223.9006347656, 661.8003540039, 884.8544311523, 1384.0025634766, 2760.4465332031, 7811.0014648438, 2927.7336425781,
                        638.9751586914, 696.5787353516, 530.7892456055, 648.5638427734, 889.94921875, 1170.0031738281, 13165.86328125, 3567.0439453125, 598.9104003906, 2136.6420898438, 550.4777832031,
                        4788.4853515625, 7577.4145507813, 9951.6845703125, 633.6901245117, 8566.72265625, 6111.5356445313, 603.5051269531, 547.0169067383, 1030.9359130859, 3526.8361816406,
                        775.7020874023, 977.0328979492, 573.4454956055, 942.9322509766, 856.3784790039, 1111.9583740234, 1140.8024902344, 1289.6633300781, 9985.4521484375, 1866.3151855469,
                        15186.7138671875, 750.4580688477, 782.4721069336, 1077.7072753906, 545.8282470703, 7053.7202148438, 513.7174682617, 622.5845336914, 553.4197998047, 688.5629272461,
                        1012.749206543, 1117.6733398438, 527.3670043945, 697.4555664063, 6784.0971679688, 739.5375366211, 874.3876342773, 24654.7109375, 3577.7976074219, 24185.4765625,
                        2528.0358886719, 574.4848632813, 647.6321411133, 2600.6940917969, 493.2133178711, 10003.0302734375, 2482.6206054688, 736.8714599609, 509.7579040527 };
                mz = mz2;
                intensity = intensity2;
            }
            if (j == 2) {
                double[] mz3 = { 110.071434, 111.1172791, 114.1379471, 115.0867233, 116.0709763, 120.0810165, 129.1023407, 130.0863647, 133.0608063, 136.0757599, 137.1325684, 141.1022949, 142.0866089,
                        142.1057892, 143.0815582, 143.1180725, 145.0971985, 147.1128387, 149.0231323, 149.0813293, 153.950592, 155.1178741, 156.1019897, 157.1336212, 161.0919037, 166.08638,
                        172.9013824, 173.0922699, 175.1192627, 182.128952, 183.1128235, 184.0970459, 185.164917, 187.1438446, 189.0869904, 193.0972748, 199.0714569, 200.1394196, 201.1234436,
                        202.1267395, 210.5132599, 217.0818939, 218.1499176, 218.8685608, 219.1531982, 228.0976715, 229.0282898, 229.118103, 231.3766327, 241.3804626, 243.1742859, 244.0929565,
                        244.1292114, 246.1555176, 254.1499023, 255.007843, 257.1898193, 258.0890808, 258.8848572, 260.1241455, 270.1082764, 271.111969, 272.6676941, 272.8900452, 277.4067383,
                        285.0091858, 288.1187439, 289.1868591, 290.1903687, 293.122467, 303.1463318, 314.6676025, 321.1767273, 332.3607788, 334.8108215, 340.820343, 341.1454163, 349.6712341,
                        349.6844482, 359.1559448, 367.1973877, 367.209137, 367.2991333, 390.234314, 391.2380066, 447.3330994, 487.2503357, 488.235321, 488.2549133, 502.703064, 505.2611084,
                        506.2651672, 521.2680664, 544.3269043, 545.3035889, 615.1711426, 655.3071899 };
                double[] intensity3 = { 554.5115356445, 576.2714233398, 470.5877075195, 831.346862793, 808.5812988281, 540.8423461914, 15454.1044921875, 10687.373046875, 2562.8276367188,
                        985.1844482422, 5154.5366210938, 11838.80078125, 746.5007324219, 590.8298339844, 2232.1176757813, 2862.2277832031, 999.6495361328, 20458.943359375, 549.176574707,
                        564.7764282227, 541.6581420898, 2744.7907714844, 13228.37109375, 1072.2976074219, 668.5700073242, 1015.8220214844, 566.4951171875, 3130.7785644531, 5293.4462890625,
                        984.9155883789, 10520.90234375, 2768.6892089844, 2203.5717773438, 578.719909668, 2560.7993164063, 580.1266479492, 11263.375, 4808.3188476563, 122865.515625, 7319.7158203125,
                        2671.2126464844, 5787.3247070313, 24145.658203125, 560.5859375, 893.0471801758, 981.86328125, 599.716003418, 3674.5551757813, 631.608215332, 567.0170288086, 7594.8212890625,
                        840.05859375, 791.4499511719, 533.7921142578, 714.3071289063, 2784.4916992188, 2421.3828125, 539.7557373047, 665.4076538086, 787.3020629883, 22507.0078125, 1141.7131347656,
                        653.4030151367, 780.8794555664, 521.9017944336, 652.1410522461, 13041.5927734375, 12533.13671875, 640.3876953125, 887.7508544922, 693.4885864258, 552.3706665039,
                        659.1276245117, 503.3168945313, 586.6461181641, 1149.9792480469, 1115.6361083984, 626.9268188477, 555.3795166016, 2641.4448242188, 910.6457519531, 758.4725341797,
                        8677.2880859375, 11298.2587890625, 1102.0684814453, 550.0299072266, 4999.42578125, 900.1571044922, 611.5407104492, 591.0953369141, 31726.78125, 5554.0678710938,
                        1095.4444580078, 889.14453125, 989.8300170898, 472.4118347168, 565.1219482422 };
                mz = mz3;
                intensity = intensity3;
            }
            if (j == 3) {
                double[] mz4 = { 110.071701, 111.0749207, 113.071312, 114.1415176, 115.0869827, 116.0710602, 120.0810928, 127.0868988, 129.1024475, 129.8681793, 130.0653534, 130.0865326, 131.0686493,
                        132.0809937, 136.0760803, 136.2918549, 141.1024323, 145.0610046, 147.1129456, 148.1164246, 156.0809631, 157.0973053, 159.0918427, 160.0951996, 166.0615692, 167.4468231,
                        169.0972595, 169.1337585, 170.1369781, 171.1129303, 172.3184357, 173.1286774, 175.1191101, 178.1342621, 186.1239166, 187.086792, 187.1080933, 187.1274872, 189.0692139,
                        190.068573, 195.088028, 197.1287384, 198.1321716, 201.1025696, 204.1344147, 206.1291199, 209.1399689, 211.1445618, 214.1187286, 224.1035309, 225.1389313, 226.1190033,
                        227.1223297, 228.1131744, 228.1342926, 229.0973816, 231.1448822, 235.1193085, 237.1346893, 242.186554, 244.1296082, 246.0908051, 246.1238251, 254.1502075, 256.1080322,
                        257.0921021, 259.6817017, 260.1969604, 263.1503601, 266.1499634, 267.1334229, 270.1810608, 274.1185913, 275.1712341, 276.1020203, 282.1802368, 286.1550903, 294.1564026,
                        295.4968567, 297.1559753, 300.155304, 303.111969, 303.1289978, 310.1141968, 311.1713562, 313.1297302, 313.1491699, 313.1871033, 314.1125793, 314.1339722, 315.1662903,
                        322.1513672, 323.155304, 323.1712646, 324.130127, 325.1504211, 329.2183533, 330.1925964, 331.1401062, 335.1716919, 339.1679077, 339.2026062, 341.1816101, 342.1772461,
                        344.1088257, 345.1227417, 345.1593628, 347.2288818, 348.2323608, 355.2129211, 357.1593018, 361.2344666, 362.2189636, 373.1515808, 374.1851807, 374.2401428, 379.1362305,
                        379.2453613, 380.1927795, 380.2481689, 382.2437134, 383.2077026, 384.2115173, 386.1822205, 389.229187, 390.1444702, 400.2554321, 402.1802368, 406.1875916, 407.2401733,
                        408.2441406, 409.2459106, 410.2394409, 413.2504272, 414.2711487, 424.2195129, 428.177002, 428.2504883, 437.2157593, 441.2463684, 444.1914978, 446.2976685, 447.2988892,
                        448.1578979, 449.1611023, 452.2290649, 456.1916199, 461.2185059, 461.2878723, 462.1820068, 466.1681824, 470.2403259, 471.2446594, 472.1865845, 473.2192688, 473.3094788,
                        484.1782837, 484.2579956, 485.3085938, 487.2550049, 487.7567444, 488.7183228, 489.2131042, 496.1795349, 497.2192383, 501.252533, 501.7550354, 503.3190613, 504.2927246,
                        504.3226624, 509.2528381, 511.6417236, 515.2286987, 523.7526855, 526.2089844, 527.2633057, 528.2783813, 529.763855, 530.2653198, 530.7664185, 537.7512817, 538.25, 542.2402954,
                        543.2244873, 545.78302, 555.2533569, 559.196167, 560.2501831, 565.2373657, 566.2391968, 572.2493896, 574.3562622, 575.359375, 576.2244873, 576.3613892, 583.2484131,
                        584.2887573, 584.9671021, 589.3826904, 590.5994873, 590.9331665, 593.9641113, 594.2724609, 594.2979126, 594.630188, 595.2662964, 599.2619019, 600.2455444, 607.305603,
                        607.9355469, 608.8062134, 609.2649536, 609.3065796, 609.8085938, 612.2493286, 612.2817383, 612.9710083, 613.6070557, 616.3109741, 616.8139648, 617.270874, 617.3770752,
                        618.3800659, 622.8032837, 623.3052979, 623.3522949, 623.8049927, 624.8243408, 625.3269653, 625.8259277, 629.3087769, 630.2717896, 634.2229614, 640.3483276, 641.3391724,
                        649.8557129, 651.3134155, 651.6471558, 651.9796143, 652.2333374, 653.2374878, 657.2813721, 658.2669678, 658.3426514, 658.8430786, 659.3056641, 670.2436523, 671.3237915,
                        672.3380737, 672.8400879, 673.3391113, 673.4249878, 674.3200684, 674.4285889, 674.6552124, 674.9893799, 675.2924805, 675.3222046, 675.9883423, 680.3241577, 680.6589355,
                        680.963623, 680.9923706, 681.3302002, 686.399292, 687.3248901, 691.6608887, 691.9915161, 693.6622925, 694.331604, 696.2972412, 696.3302612, 697.3275146, 697.6620483,
                        697.9951782, 698.3287964, 698.6628418, 698.9917603, 699.3157349, 700.0021362, 700.3359985, 703.3307495, 703.6655273, 703.9990234, 704.3331299, 704.4108887, 708.333252,
                        709.333252, 709.6692505, 710.0016479, 716.3412476, 722.885376, 723.3878174, 727.0216675, 727.3546753, 728.8812256, 729.3815308, 731.352417, 733.0253906, 733.3601074,
                        733.6938477, 736.3544312, 736.6879883, 737.020874, 741.3170166, 742.6920166, 747.3061523, 751.3024292, 752.3051147, 755.8552856, 757.3911743, 757.8936157, 758.3939209,
                        765.3168945, 766.3220825, 769.3131104, 770.4434204, 772.3446655, 773.3509521, 773.8519287, 774.3530884, 775.043335, 779.3670044, 783.3291626, 787.4678955, 788.4703369,
                        789.4733276, 803.3713379, 808.3589478, 810.3719482, 816.8654175, 817.3688354, 821.9127808, 822.4119873, 822.9143677, 833.3647461, 838.369873, 840.3737183, 841.8769531,
                        842.3705444, 842.8764038, 843.3744507, 851.3758545, 851.8781738, 852.3798828, 854.3995972, 855.7609253, 860.3807373, 860.8851929, 864.3909912, 864.4359741, 865.3909912,
                        865.4417114, 870.0933838, 870.4278564, 871.4158325, 872.4161377, 876.3934937, 876.4456177, 876.9477539, 877.4489136, 882.3973999, 885.3942871, 886.9098511, 887.4129639,
                        890.4420776, 890.9442139, 891.4459229, 894.9141846, 895.9180298, 896.4204712, 896.9204712, 899.4361572, 900.9120483, 901.4134521, 901.4690552, 901.9152222, 902.4176025,
                        910.9036865, 911.4049683, 911.9036865, 912.7774658, 918.0413208, 918.5062866, 918.953125, 919.4586792, 919.5082397, 919.9053955, 919.9539185, 920.40802, 920.512146,
                        920.9060059, 927.9630127, 937.4363403, 938.4411621, 942.4500732, 951.4378662, 955.9464111, 957.519104, 960.4371948, 960.9343872, 961.44104, 963.4528198, 964.447937,
                        965.4516602, 967.4605713, 968.4612427, 969.4411011, 969.9401245, 970.442627, 975.5299072, 976.4676514, 976.5332031, 976.9672241, 977.4685059, 977.5324097, 977.9678955,
                        978.9451904, 979.4481201, 993.9794922, 994.4717407, 996.9744873, 997.4754639, 997.9810791, 1000.479309, 1001.500671, 1002.503418, 1003.501038, 1007.463684, 1007.977295,
                        1008.479858, 1010.977539, 1011.478149, 1011.979675, 1014.454529, 1019.983032, 1020.484802, 1020.984436, 1021.488647, 1029.488159, 1031.506226, 1035.000244, 1035.995483,
                        1036.481445, 1036.979492, 1039.486328, 1039.993408, 1040.495361, 1040.994995, 1041.498169, 1041.994507, 1044.552368, 1045.010376, 1045.488525, 1045.550171, 1045.989502,
                        1046.488159, 1046.990356, 1047.502686, 1047.983765, 1048.49231, 1048.98999, 1049.502075, 1049.997925, 1050.518311, 1051.519043, 1054.49292, 1054.994141, 1055.495117,
                        1055.996826, 1056.497437, 1058.521118, 1059.526001, 1062.562012, 1063.498413, 1063.566406, 1064.000366, 1064.500732, 1064.568726, 1065.000854, 1065.568481, 1068.507935,
                        1074.495605, 1076.506226, 1078.515015, 1079.523438, 1080.520386, 1080.806152, 1081.029297, 1082.525391, 1084.530151, 1086.513916, 1090.027222, 1090.530396, 1091.032837,
                        1091.539063, 1095.019775, 1095.52356, 1096.024414, 1098.53125, 1099.033569, 1099.537109, 1100.037842, 1100.539429, 1101.0271, 1104.026611, 1104.52832, 1105.029419, 1105.529541,
                        1106.03418, 1107.484497, 1108.483765, 1112.535522, 1113.032104, 1113.532959, 1114.035034, 1114.534302, 1115.041138, 1125.496826, 1131.057617, 1136.033691, 1140.056274,
                        1145.037842, 1149.535522, 1152.552124, 1153.056763, 1153.558472, 1161.55957, 1162.062256, 1162.558472, 1163.064453, 1167.555664, 1197.094727, 1197.603394, 1198.099243,
                        1198.600952, 1202.089355, 1202.591553, 1203.088745, 1207.557739, 1211.093872, 1211.593628, 1212.094971, 1212.597778, 1213.094849, 1216.608032, 1217.601318, 1230.632935,
                        1231.629639, 1232.623169, 1236.588013, 1237.586792, 1244.602905, 1245.603638, 1248.641968, 1249.643555, 1250.646484, 1251.645386, 1274.11853, 1274.617676, 1290.639282,
                        1312.746948, 1315.680542, 1316.679443, 1339.143433, 1339.656006, 1340.146606, 1343.672363, 1344.673828, 1345.670776, 1347.713379, 1348.716187, 1368.15271, 1373.640381,
                        1374.643677, 1376.156982, 1376.675781, 1427.753052, 1428.75415, 1444.764038, 1445.766357, 1446.765015, 1456.752563, 1457.755737, 1458.760498, 1513.773315, 1545.686035,
                        1546.695923, 1559.109497, 1642.819092, 1643.821167, 1644.824951, 1645.83374, 1683.733154, 1684.745361, 1685.75, 1701.746094, 1702.750122, 1703.753052, 1704.763672, 1720.752441,
                        1779.873779, 1790.826538, 1791.828247, 1800.816162, 1801.819336, 1802.821533, 1818.827271, 1819.822632, 2014.950317, 2015.95459, 3704.048584, 3704.838867 };
                double[] intensity4 = { 67613.671875, 1831.9465332031, 999.1885986328, 958.4008789063, 1009.7340087891, 1825.5847167969, 3966.4675292969, 1351.3416748047, 12182.810546875,
                        820.7251586914, 50839.9453125, 10942.630859375, 3394.8950195313, 14558.849609375, 2007.9077148438, 856.5766601563, 1737.4708251953, 1322.9926757813, 22451.431640625,
                        1391.1329345703, 962.4296875, 1605.8873291016, 170024.8125, 12487.916015625, 1660.4964599609, 815.3684692383, 1365.0274658203, 71656.28125, 4688.6533203125, 3498.9609375,
                        836.457824707, 3566.8562011719, 826.658203125, 5253.681640625, 14340.4482421875, 1761.1831054688, 1354.2014160156, 1605.0234375, 3294.0256347656, 967.9634399414,
                        1873.9647216797, 38019.03515625, 3443.1926269531, 1046.3061523438, 3608.8366699219, 4732.384765625, 2094.5964355469, 1036.67578125, 9351.779296875, 1055.6995849609,
                        1295.9558105469, 4108.091796875, 1225.9825439453, 1251.7897949219, 3176.5747070313, 1577.9881591797, 936.434753418, 7339.546875, 4027.986328125, 1431.4146728516,
                        3395.1850585938, 4719.8984375, 4817.9555664063, 924.7261352539, 1573.5100097656, 5306.6904296875, 952.1651611328, 8859.248046875, 5049.2109375, 4426.1528320313,
                        1125.5798339844, 992.5237426758, 10431.1689453125, 5023.029296875, 1008.2269287109, 1001.2357788086, 1712.2807617188, 3811.3051757813, 778.0229492188, 4415.9418945313,
                        1179.8687744141, 4172.1923828125, 700.6480712891, 3647.6672363281, 1882.4956054688, 8040.0864257813, 935.1657714844, 915.0415039063, 863.4573364258, 855.5131225586,
                        3719.1784667969, 1580.4450683594, 830.8236083984, 4327.2377929688, 1468.5124511719, 1462.2341308594, 1198.4080810547, 1605.6645507813, 1775.4102783203, 1556.4569091797,
                        866.1019897461, 4526.7900390625, 1763.3646240234, 8289.9013671875, 823.8076171875, 1276.4318847656, 1604.6634521484, 44400.56640625, 6639.1899414063, 1967.6704101563,
                        946.6687011719, 1094.1202392578, 3578.7458496094, 1435.3666992188, 3443.7131347656, 1041.2733154297, 1823.7592773438, 35905.96484375, 1437.9211425781, 5136.4462890625,
                        1225.8950195313, 14152.7119140625, 2050.1188964844, 1426.9207763672, 951.7576293945, 4704.3745117188, 1455.4357910156, 3697.1135253906, 953.5454101563, 73513.28125, 9869.71875,
                        1730.7620849609, 4764.7265625, 1081.1180419922, 1131.2509765625, 1146.6674804688, 1294.9165039063, 3573.8493652344, 1508.3453369141, 4031.9606933594, 1451.2650146484,
                        7929.5493164063, 1017.5032958984, 1862.6419677734, 895.2436523438, 3725.5588378906, 1552.1726074219, 1190.9484863281, 1117.0860595703, 1405.5310058594, 3731.0222167969,
                        8610.9375, 940.0627441406, 3510.90234375, 1835.7896728516, 1201.5424804688, 1299.4645996094, 1098.6483154297, 843.2536621094, 8828.162109375, 1963.3797607422, 1075.6431884766,
                        6058.390625, 1744.6840820313, 942.5045776367, 6834.0810546875, 1848.6473388672, 42207.390625, 1621.8843994141, 9898.6220703125, 1873.8389892578, 948.9799804688,
                        1111.1832275391, 1000.5302734375, 1179.3374023438, 4011.4028320313, 1464.4713134766, 12671.3486328125, 4034.0246582031, 1043.2894287109, 2100.6787109375, 1106.0621337891,
                        1268.5225830078, 1902.9477539063, 834.6474609375, 3748.8713378906, 3715.6154785156, 1144.4217529297, 6517.1352539063, 1399.7967529297, 924.2121582031, 69331.328125,
                        17037.453125, 1628.90234375, 1434.5238037109, 3936.4692382813, 950.1052856445, 1042.3439941406, 1743.4653320313, 977.1047973633, 960.9440917969, 1613.6340332031,
                        875.8720703125, 3557.8122558594, 857.7406616211, 2102.2802734375, 1896.6119384766, 4195.224609375, 1777.6926269531, 997.5719604492, 9931.87890625, 1873.0654296875,
                        7053.4243164063, 2038.0284423828, 977.6705322266, 1612.5084228516, 3908.1884765625, 1116.2249755859, 9910.85546875, 4256.3247070313, 1891.8089599609, 7618.1352539063,
                        1588.4603271484, 11892.5009765625, 7922.3549804688, 1177.6960449219, 1233.4965820313, 4000.65625, 1971.0622558594, 1144.8709716797, 3838.0417480469, 3650.5439453125,
                        4021.9497070313, 1028.8641357422, 933.4574584961, 1161.5887451172, 11866.025390625, 11730.61328125, 8505.388671875, 4334.0034179688, 1571.8179931641, 1222.861328125,
                        4181.6264648438, 3500.0158691406, 4356.9150390625, 964.7109375, 1131.0045166016, 1385.6940917969, 17401.32421875, 8147.52734375, 5191.951171875, 21055.20703125,
                        4795.2631835938, 7016.205078125, 5540.0209960938, 3746.4609375, 3813.4887695313, 1868.4936523438, 1174.4085693359, 10542.578125, 12092.177734375, 1225.3231201172,
                        8095.9526367188, 3227.25390625, 1589.4213867188, 1295.8977050781, 1608.7247314453, 1717.8787841797, 3697.5788574219, 1687.7242431641, 1518.0079345703, 1049.7507324219,
                        28697.58984375, 32610.123046875, 20141.548828125, 6863.3876953125, 1467.6721191406, 1263.6749267578, 3579.3857421875, 3744.0537109375, 4038.5363769531, 42395.4921875,
                        41557.8203125, 21450.4765625, 8526.8427734375, 4392.0654296875, 1527.1987304688, 8351.9599609375, 10923.126953125, 8195.490234375, 8294.0166015625, 10410.6640625,
                        8898.20703125, 6721.0126953125, 3463.333984375, 1438.3759765625, 6360.5078125, 984.6576538086, 4657.3266601563, 8838.3857421875, 5425.056640625, 11785.9912109375,
                        11700.1650390625, 7951.2866210938, 1709.7021484375, 3664.91015625, 1931.9256591797, 7128.109375, 1587.5677490234, 1173.5155029297, 1378.2398681641, 1444.5145263672,
                        1730.3620605469, 5569.734375, 1122.876953125, 2124.0432128906, 3521.9382324219, 5712.3891601563, 6410.4106445313, 1675.9910888672, 1069.2980957031, 4169.3125, 1363.3560791016,
                        1350.7581787109, 34752.70703125, 11545.6162109375, 1503.767578125, 1353.6374511719, 1316.2670898438, 1351.3453369141, 3812.3640136719, 1698.4130859375, 8076.8422851563,
                        7031.2348632813, 5038.1411132813, 1013.2843017578, 3763.9240722656, 1647.3623046875, 1327.1331787109, 8387.7451171875, 7701.0517578125, 4320.9033203125, 12654.177734375,
                        11012.5, 1971.1854248047, 4827.4790039063, 1124.4234619141, 1866.1986083984, 3766.3188476563, 7568.9580078125, 8040.0034179688, 1650.9626464844, 2914.7033691406,
                        1921.0505371094, 2089.9423828125, 5269.1821289063, 1332.2758789063, 1240.2318115234, 4831.001953125, 5465.8325195313, 1048.6594238281, 4384.263671875, 1300.1697998047,
                        1123.3106689453, 1361.1683349609, 14360.2744140625, 8876.24609375, 3995.9702148438, 1307.1307373047, 4446.916015625, 3446.712890625, 1353.5421142578, 1177.6708984375,
                        8276.275390625, 5276.1499023438, 1212.6909179688, 1191.4787597656, 4575.298828125, 2075.0822753906, 3819.287109375, 1309.4663085938, 1419.3110351563, 3071.8327636719,
                        23697.59375, 3762.7653808594, 6431.6264648438, 7176.1220703125, 3925.6101074219, 1090.9129638672, 2097.3466796875, 1347.7740478516, 3411.7290039063, 3431.7861328125,
                        5340.994140625, 1852.5231933594, 1746.2845458984, 1126.9534912109, 1785.8309326172, 1453.5706787109, 3468.7690429688, 1930.2518310547, 1661.228515625, 4634.259765625,
                        3929.1928710938, 1459.2158203125, 1838.2846679688, 2002.5455322266, 5111.5932617188, 5053.2260742188, 1333.640625, 67653.7734375, 14176.068359375, 25679.259765625,
                        21781.587890625, 11401.591796875, 5983.78125, 2060.5275878906, 1334.3021240234, 1852.6478271484, 1053.5278320313, 1056.0535888672, 1065.09765625, 1419.2072753906,
                        1369.3054199219, 1258.9128417969, 9635.0419921875, 1377.5627441406, 1896.4713134766, 901.6781616211, 1636.8104248047, 1504.0844726563, 10244.671875, 9501.1240234375,
                        5926.0981445313, 1003.0361938477, 11722.3798828125, 10594.1884765625, 5657.9287109375, 1125.4777832031, 990.3666992188, 1257.4001464844, 1038.5245361328, 1552.7928466797,
                        1945.0150146484, 1675.6466064453, 3548.595703125, 1287.2420654297, 7584.8100585938, 5986.6630859375, 5307.4858398438, 1598.3850097656, 5792.1904296875, 1035.7362060547,
                        21022.986328125, 2816.1962890625, 29567.01953125, 12437.767578125, 6346.8173828125, 1697.0704345703, 1139.6850585938, 4342.05078125, 1101.6555175781, 4137.2646484375,
                        7001.8383789063, 7450.8920898438, 1844.3972167969, 46591.42578125, 53875.75390625, 27965.853515625, 12799.0849609375, 1486.0028076172, 3496.5556640625, 4040.9650878906,
                        69656.40625, 15916.6220703125, 32769.18359375, 26351.953125, 12287.826171875, 11873.8115234375, 5757.533203125, 1507.4136962891, 1590.2685546875, 1105.1666259766,
                        1644.2016601563, 3845.2897949219, 1577.396484375, 1382.6195068359, 958.8025512695, 1509.9722900391, 1502.0208740234, 1393.5240478516, 1398.1911621094, 12246.8232421875,
                        16068.87109375, 9513.73046875, 2652.6105957031, 5985.78515625, 9609.3359375, 1711.3336181641, 5758.61328125, 22942.10546875, 28251.693359375, 15892.2275390625, 4276.1005859375,
                        1098.1518554688, 62993.7109375, 76822.1796875, 45731.8828125, 16688.46484375, 3593.5549316406, 1601.8675537109, 1082.4737548828, 1049.5546875, 48567.3359375, 49414.4609375,
                        26510.427734375, 10042.5791015625, 1928.2321777344, 1364.0875244141, 1379.0983886719, 1051.0078125, 1592.8907470703, 1167.6193847656, 1667.6839599609, 4481.0166015625,
                        1985.1275634766, 1897.2416992188, 7234.30859375, 9681.66796875, 3876.7641601563, 1759.6812744141, 1144.9030761719, 6509.0859375, 6640.9287109375, 8578.3525390625,
                        1543.8883056641, 3737.509765625, 3506.3515625, 1044.8107910156, 1125.4560546875, 25235.189453125, 32663.890625, 19117.005859375, 10095.1240234375, 1420.8492431641,
                        1800.1805419922, 1100.8802490234, 3973.0207519531, 3631.2604980469, 3919.083984375, 6586.3974609375, 1920.9197998047, 7040.1791992188, 1632.4958496094, 55801.0625,
                        30595.806640625, 9000.96875, 3344.1628417969, 3384.78515625, 3688.1376953125, 1301.1402587891, 1240.0732421875, 1316.4320068359, 1497.4797363281, 1581.4860839844,
                        1384.4041748047, 1241.3525390625, 11051.4404296875, 10548.44921875, 1888.7368164063, 7026.2783203125, 3786.4848632813, 1467.5749511719, 1106.9543457031, 1319.2423095703,
                        1074.6340332031, 1109.8099365234, 1770.2413330078, 1301.8181152344, 21688.29296875, 14569.9580078125, 7291.79296875, 11158.126953125, 8758.1328125, 3891.57421875,
                        1810.9868164063, 1755.0939941406, 1523.9315185547, 1108.177734375, 11509.0380859375, 8212.3173828125, 4788.3774414063, 1208.1584472656, 3808.3190917969, 1204.9481201172,
                        1501.1110839844, 4118.5512695313, 4219.8735351563, 1431.0915527344, 999.6631469727, 1256.4339599609, 1322.5466308594, 2959.7475585938, 1908.0208740234, 5398.2744140625,
                        4858.6484375, 1337.1431884766, 4596.2534179688, 3689.3454589844, 1335.6721191406, 1296.7269287109, 1259.4842529297, 1252.8992919922 };
                mz = mz4;
                intensity = intensity4;
            }
            double peptidmass = 406.2002 * 1.005;
            double rt = 34.88659 * i;
            int chargestate = 2;
            int id = i;
            msm.addMS(typ, searchengine, mz, intensity, peptidmass, rt, chargestate, id);
            j++;
            if (j == 4) {
                j = 0;
            }
        }

        System.out.println(Summary.makeSummary(msm));

        long startTime = System.currentTimeMillis();

        Deisotope deiso = new Deisotope();
        MassSpectrometryMeasurement d = deiso.deisotopeMSM(msm, false, "first", "/srv/lucas1/test.properties", 5, 0.3, 0.01);

        long endTime = System.currentTimeMillis();

        System.out.println(Summary.makeSummary(d));

        time = endTime - startTime;

        System.out.println("Total execution time: " + time + "ms (100%)");
        System.out.println();

        // System.out.println("new score execution time: " + IsotopicClusterGraph.timescore2 + "ms (" + (int) (IsotopicClusterGraph.timescore2 / time * 100) + "%)");
        // System.out.println("f1 execution time: " + Score.timescoref1 + "ms (" + (int) (Score.timescoref1 / time * 100) + "%)");
        // System.out.println("f2 execution time: " + Score.timescoref2 + "ms (" + (int) (Score.timescoref2 / time * 100) + "%)");
        // System.out.println("f3 execution time: " + Score.timescoref3 + "ms (" + (int) (Score.timescoref3 / time * 100) + "%)");
        // System.out.println("f4 execution time: " + Score.timescoref4 + "ms (" + (int) (Score.timescoref4 / time * 100) + "%)");
        // System.out.println("f5 execution time: " + Score.timescoref5 + "ms (" + (int) (Score.timescoref5 / time * 100) + "%)");
    }
}