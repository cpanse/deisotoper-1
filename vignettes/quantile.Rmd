---
title: "Deisotoper: Quantiles"
author: "Lucas Schmidt"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Quantiles}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Quantiles

## Loading the quantile test data

The quantile test data contains 20 mass spectra which are from four different quantiles.

```{r}
library(deisotoper)

QUANTILE <- load(system.file("extdata", name = 'FourQuantileTestDataDDA.RData', package = "deisotoper"))

QUANTILEMSM <- jCreateMSM(get(QUANTILE))
```


## Differences between before and after deisotoping

Differences between non deisotoped and deisotoped spectra are marked in red.

```{r fig.retina=3, fig.width=8, fig.height=5}
for(i in 0:19) {
  MS <- QUANTILEMSM$getMSlist()$get(as.integer(i))
  MSd <- jDeisotopeMS(MS)
  diff <- c(setdiff(MS$getMzArray(), MSd$getMzArray()), setdiff(MSd$getMzArray(), MS$getMzArray()))

  plot(x = MS$getMzArray(), y = MS$getIntensityArray(), type = "h", xlab = "mZ", ylab = "Intensity", main = paste("Spectra Number ", i+1, sep = ""))

  plot(x = MSd$getMzArray(), y = MSd$getIntensityArray(), type = "h", xlab = "mZ", ylab = "Intensity", main = paste("Spectra Number ", i+1, " deisotoped", sep = ""))
  abline(v=diff, col="#FF000033", lwd = 2)
}
```