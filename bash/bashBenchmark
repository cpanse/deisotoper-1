#!/bin/bash

#Usage (normal): ./bashBenchmark X Y Z (X, Y, Z are .mgf-files)
#Usage (parallel): find FOLDER -name "*.mgf" | parallel ./bashBenchmark (FOLDER contains .mgf-files)

RBENCHMARK="../R/rBenchmark.R"
MGF2RDATA="./mgf2RData.pl"

function benchmark() {
	in="$1"
	[ -e "$in" ] || exit 1

	out="${in%.*}_benchmark"
	tfile="temp.RData"

	rm -f "$tfile"
	"$MGF2RDATA" -n="${tfile%.*}" > /dev/null < "$in"
	[ -s "$tfile" ] || exit 1
	"$RBENCHMARK" "$tfile" "$out" > /dev/null
	rm -f "$tfile"
}

for i in "$@" 
do
	benchmark "$i"
done
